<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Shop</title>

<link rel="stylesheet prefetch" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="css/style.css">

<style media="all">



</style>

</head>

<body>

    <div class="fake-nav"></div><!-- special for content under navigation, when nav situate in top height==nav.height -->
    <div id="nav">

    <!--  START search input-->
        <div class="search-container">
            <input id="search-toggle" type="checkbox">
            <label class="search-backdrop" for="search-toggle"></label>
            <div class="search-content">
                <form id="search-form" action="">
                    <input type="search" class="input-search" placeholder="Input what you want to search" required>
                    <button type="submit" id="searchsubmit" class="fa fa-search fa-4x"></button>
                </form>
            </div>
        </div>
    <!--  END search input-->

        <ul class="list-menu">

        <!--   START bottom in responsive menu    -->
            <input id="responsive-toggle" type="checkbox">

            <label for="responsive-toggle" id="btm-open-menu">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </label>
        <!--   END bottom in responsive menu    -->

            <li class="item-menu shop">
                <i href="shop.html">shop</i>
                <ul class="sub-menu">
                    <li>
                        <h3 class="title-sub-menu"><a href="index.html">Home</a></h3>
                    </li>
                    <li>
                        <h3 class="title-sub-menu"><a href="blog.html">Blog</a></h3>
                    </li>
                    <li>
                        <h3 class="title-sub-menu"><a href="about.html">About</a></h3>
                    </li>
                    <li>
                        <h3 class="title-sub-menu"><a href="contact.html">Contact</a></h3>
                    </li>
                    <li>
                        <h3 class="title-sub-menu"><a href="shop.html">Shop</a></h3>
                    </li>
                </ul>
            </li>
            <li class="item-menu logo">
              <a href="index.html">LOGO<br><span>Short Description</span></a>
            </li>
            <li class="item-menu nav-icons">
                <label for="search-toggle"><i class="fa fa-search button-search" aria-hidden="true"></i></label>
                <label for="modal-basket-toggle" id="cart_trigger"><i class="fa fa-shopping-bag" aria-hidden="true"></i></label>
                <label for="modal-login-toggle"><i class="fa fa-user" aria-hidden="true"></i></label>
            </li>
        </ul>
    </div>
    <!--  END NAVIGAION  -->

  <header>
    <hgroup>
       <h1>My Web Shop</h1>

    </hgroup>
  </header>

  <div class="wrapper">

      <ul class="grid cards caption-hover">
          
          

      </ul>
  </div><!-- /container -->

<footer>
  <p>§</p>
  <p>© 20017 <a href="#">My Site</a></p>
</footer>

  <div id="cart">
        <h2>Cart</h2>
        <ul class="cart-items" id="cart_items">

        </ul> <!-- cd-cart-items -->

        <div class="cart-total">
            <p>Total <span>$39.96</span></p>
        </div> <!-- cd-cart-total -->

        <a href="#" class="checkout-btn">Checkout</a>

        <p class="go-to-cart"><a href="#">Go to cart page</a></p>
    </div> <!-- cd-cart -->

<script type="text/javascript">
  window.onload = function(){

    var data = [{
        id: 0,
        name: 'Product 0',
        price: 177,
        carousel: [1,2,3]
    },
    {
        id: 1,
        name: 'Product 1',
        price: 77,
        carousel: [2,3,4]
    },
    {
        id: 2,
        name: 'Product 2',
        price: 88,
        carousel: [3,4,5]
    },
    {
      id: 3,
      name: 'Product 3',
      price: 277,
      carousel: [6,1,2]
    },
    {
      id: 4,
      name: 'Product 4',
      price: 277,
      carousel: [5,6,4]
    },
    {
      id: 5,
      name: 'Product 5',
      price: 277,
      carousel: [4,5,3]
    }
    ];


function createItem(j){
    
    var li = document.createElement('li');
    
    li.setAttribute('productId', data[j].id);
    
    li.classList.add('product') 

    var div = document.createElement('div');

    var figure = document.createElement('figure');

    var div2 = div.cloneNode(true);
    div2.setAttribute('class', "images-wrapper");
    div2.setAttribute('index', data[j].id);
    var div3 = div.cloneNode(true);
    div3.setAttribute('class', "controls");
    var div4 = div.cloneNode(true);
    div4.setAttribute('class', "prev-arrow prev");
    div4.innerHTML = '<i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i>';
    div3.appendChild(div4);
    var div5 = div.cloneNode(true);
    div5.setAttribute('class', "next-arrow next");
    div5.innerHTML = '<i class="fa fa-arrow-circle-o-right" aria-hidden="true"></i>';
    div3.appendChild(div5);

    div2.appendChild(div3);

    figure.appendChild(div2);


    var figcaption = document.createElement('figcaption');

    var h3 = document.createElement('h3');
    h3.classList.add("title");
    h3.innerHTML = data[j].name;
    
    var span = document.createElement('span');
    span.classList.add("price");
    span.innerHTML = data[j].price;

    var a = document.createElement('a');
    a.setAttribute('href',"#!");

    a.classList.add("add");
    a.innerHTML = 'Add To Cart';

    figcaption.appendChild(h3);
    figcaption.appendChild(span);
    figcaption.appendChild(a);
    
    figure.appendChild(figcaption);

    var div1 = document.createElement('div');
    div1.setAttribute('class',"carousel");

    var img = document.createElement('img');

    for(var i=0; i<data[j].carousel.length;i++){
        var img1 = img.cloneNode(true);
        img1.setAttribute('src',"images/"+data[j].carousel[i]+".jpg");
        img1.setAttribute('alt',data[j][name]);
        div1.appendChild(img1);
    }

    li.appendChild(div1);
    li.appendChild(figure);
    return li;

  }

  for (var i=0; i<data.length; i++) {
    document.querySelector(".grid").appendChild(createItem(i));
    }


   function createCartItem(item_id, productName, price, bg){

        var li = document.createElement('li');

        li.setAttribute('id',item_id);
        li.setAttribute("class", "cart-product");

        var span = document.createElement('span');
        var input = document.createElement('input');
        input.setAttribute("class", "qty");
        input.setAttribute('id',"qty_"+item_id);
        input.setAttribute("value", 1);
        span.appendChild(input);

        var div = document.createElement('div');
        div.setAttribute("class", "price");
        div.innerHTML = productName+'<br/>'+'<span class="item-prices" id="price_'+item_id+'">'+price+'</span>&nbsp;';

        li.appendChild(span);
        li.appendChild(div);
        li.querySelector('.qty').style.backgroundImage = 'url(' + bg + ')';

        return li;
    }


   var addButtons = document.getElementsByClassName('add');

    for (var i=0;i<addButtons.length; i++) {

        addButtons[i].addEventListener('click', function(e) {

        var item = this.parentElement.parentElement.parentElement;

        var item_id = 'item_' + item.getAttribute('productId');

        var bg = item.children[0].children[0].getAttribute('src');
               
        var title =this.parentElement.querySelector(".title").innerHTML;

        var price = this.parentElement.querySelector(".price").innerHTML;

        cart_items.append(createCartItem(item_id, title, price, bg));
        });

    }





    cart_trigger.onclick = function () {
        var cart = document.getElementById('cart');
        toggle_panel_visibility(cart, document.body);
    };


    function toggle_panel_visibility(panel, body) {
        if (panel.classList.contains('speed-in')) {
            panel.classList.remove('speed-in');
            body.classList.remove('overflow-hidden');
        } else {
            body.classList.add('overflow-hidden');
            panel.classList.add('speed-in');

        }
    }


    var carousel = document.getElementsByClassName('carousel');
    var imagesWrapper = document.getElementsByClassName('images-wrapper');
    var imagesArray = [];
    var numberOfImages = [];

    var prevArrow = document.getElementsByClassName('prev');
    var nextArrow = document.getElementsByClassName('next');

   
    for (var i=0; i<carousel.length; i++){

      var childNodes = carousel[i].childNodes;
     
      imagesArray[i] = [];

      for (var j = 0; j < childNodes.length; j++) {
      
          var currentNode = childNodes[j];
      
          if (currentNode.nodeName === 'IMG') {
              imagesArray[i].push(currentNode.src);
              currentNode.classList.add('hide');
          }
      }

      numberOfImages[i] = imagesArray[i].length;

      imagesWrapper[i].style.backgroundImage = 'url(' + imagesArray[i][0] + ')';
    }

      var currentImage = [];

      for (var i=0; i<carousel.length; i++){

            currentImage[i] = 0;

            prevArrow[i].addEventListener('click', function (e) {
                handleSlideshowArrow('prev', this.parentNode.parentNode.getAttribute('index'));
            });

            nextArrow[i].addEventListener('click',  function (e) {
                handleSlideshowArrow('next', this.parentNode.parentNode.getAttribute('index'));
            });
        }


      function handleSlideshowArrow(val, i) {
        if (val === 'prev') {
            if (currentImage[i] > 0) {
                currentImage[i]--;
            } else {
                currentImage[i] = numberOfImages[i] - 1;
            }
        } else if (val === 'next') {
            if (currentImage[i] < numberOfImages[i] - 1) {
                currentImage[i]++;
            } else {
                currentImage[i] = 0;
            }
        }
        imagesWrapper[i].classList.add('fade-out');
        imagesWrapper[i].style.backgroundImage = 'url(' + imagesArray[i][currentImage[i]] + ')';
        imagesWrapper[i].classList.remove('fade-out');
    }




  }
</script>

</body>
</html>

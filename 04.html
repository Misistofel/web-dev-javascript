<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cart</title>
    <link rel="stylesheet prefetch" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel="stylesheet prefetch" href="css/styles.css">
</head>

<body>
    <header>

    <nav class="mainnav" role="navigation">

      <ul>
          <!--   START bottom in responsive menu    -->

              <label for="responsive-toggle" id="btm-open-menu">
                  <span></span>
                  <span></span>
                  <span></span>
                  <span></span>
              </label>
          <!--   END bottom in responsive menu    -->

          <li class="item-menu shop" id="menushop">
              <i href="shop.html">shop</i>
              <ul class="sub-menu">
              <li><a href="#">Link 2</a></li>
              <li><a href="#">Link 3</a></li>
              <li><a href="#">Link 4</a></li>
              <li><a href="#">Link 5</a></li>
              <li><a href="#">Link 6</a></li>
              </ul>
          </li>
          <li class="logo">
            <a href="index.html">LOGO<br><span>Short Description</span></a>
          </li>
          <li class="nav-icons" id="navicons">
              <label for="search-toggle"><i class="fa fa-search button-search" aria-hidden="true"></i></label>
              <label for="modal-basket-toggle" id="cart_trigger"><i class="fa fa-shopping-cart" aria-hidden="true"></i></label>
              <label for="modal-login-toggle"><i class="fa fa-user" aria-hidden="true"></i></label>
          </li>
      </ul>

    </nav>
</header>

	<main>

		<h1>My SHOP</h1>

		<section class="thumbnail-grid flex">
			<a href="#!" class="flex-item">
                <div class="carousel">
                    <img src="images/1.jpg" alt="" />
                    <img src="images/2.jpg" alt="" />
                    <img src="images/3.jpg" alt="" />
                </div>
				<figure class="" id="fig0">
                    <div class="carousel__images-wrapper" index="0">
                        <div class="controls">
                            <div class="carousel__prev-arrow prev">&lt;</div>
                            <div class="carousel__next-arrow next">&gt;</div>
                        </div>
                    </div>
					<figcaption>
                        Product #1
                        <div class="quantity-input">
                          <input class="minus btn" type="button" value="-">
                          <input id="quantity_0" value="1" class="input-text quantity text" size="4"/>
                          <input class="plus btn" type="button" value="+">
                        </div>
                        <div class="button">
                         <div class="prices">$99</div>
                         <a class="addtocart">
                             <div class="add" rel="watche_1" product="Watche 1" sel="120.99">Add to Cart</div>
                             <div class="added">Added!</div>
                         </a>
                    </div>
                    </figcaption>

				</figure>
			</a>
			<a href="#!" class="flex-item">
                <div class="carousel">
                    <img src="images/4.jpg" alt="" />
                    <img src="images/5.jpg" alt="" />
                    <img src="images/6.jpg" alt="" />
                </div>
				<figure class=""  id="fig1">
                    <div class="carousel__images-wrapper" index="1">
                        <div class="controls">
                            <div class="carousel__prev-arrow prev">&lt;</div>
                            <div class="carousel__next-arrow next">&gt;</div>
                        </div>
                    </div>
					<figcaption>Product #2
                        <div class="quantity-input">
                          <input class="minus btn" type="button" value="-">
                          <input id="quantity_1" value="1" class="input-text quantity text" size="4"/>
                          <input class="plus btn" type="button" value="+">
                        </div>
                        <div class="button">
                         <div class="prices">$99</div>
                         <a class="addtocart">
                             <div class="add" rel="watche_2" product="Watche 2" sel="220.99">Add to Cart</div>
                             <div class="added">Added!</div>
                         </a>
                    </div>
                    </figcaption>
				</figure>
			</a>
			<a href="#!" class="flex-item">
                <div class="carousel">
                    <img src="images/8.jpg" alt="" />
                    <img src="images/9.jpg" alt="" />
                    <img src="images/7.jpg" alt="" />
                </div>
				<figure class=""  id="fig2">
                    <div class="carousel__images-wrapper" index="2">
                        <div class="controls">
                            <div class="carousel__prev-arrow prev">&lt;</div>
                            <div class="carousel__next-arrow next">&gt;</div>
                        </div>
                    </div>
					<figcaption>Product #3
                        <div class="quantity-input">
                          <input class="minus btn" type="button" value="-">
                          <input id="quantity_2" value="1" class="input-text quantity text" size="4"/>
                          <input class="plus btn" type="button" value="+">
                        </div>
                        <div class="button">
                         <div class="prices">$99</div>
                         <a class="addtocart">
                             <div class="add" rel="watche_3" product="Watche 3" sel="120.99">Add to Cart</div>
                             <div class="added">Added!</div>
                         </a>
                    </div>
                    </figcaption>
				</figure>
			</a>
            <a href="#!" class="flex-item">
                <div class="carousel">
                    <img src="images/7.jpg" alt="" />
                    <img src="images/5.jpg" alt="" />
                    <img src="images/6.jpg" alt="" />
                </div>
				<figure class=""  id="fig3">
                    <div class="carousel__images-wrapper" index="3">
                        <div class="controls">
                            <div class="carousel__prev-arrow prev">&lt;</div>
                            <div class="carousel__next-arrow next">&gt;</div>
                        </div>
                    </div>
					<figcaption>Product #4
                        <div class="quantity-input">
                          <input class="minus btn" type="button" value="-">
                          <input id="quantity_3" value="1" class="input-text quantity text" size="4"/>
                          <input class="plus btn" type="button" value="+">
                        </div>
                        <div class="button">
                         <div class="prices">$99</div>
                         <a class="addtocart">
                             <div class="add" rel="watche_4" product="Watche 4" sel="99">Add to Cart</div>
                             <div class="added">Added!</div>
                         </a>
                    </div>
                    </figcaption>
				</figure>
			</a>
			<a href="#!" class="flex-item">
                <div class="carousel">
                    <img src="images/5.jpg" alt="" />
                    <img src="images/5.jpg" alt="" />
                    <img src="images/6.jpg" alt="" />
                </div>
				<figure class=""  id="fig4">
                    <div class="carousel__images-wrapper" index="4">
                        <div class="controls">
                            <div class="carousel__prev-arrow prev">&lt;</div>
                            <div class="carousel__next-arrow next">&gt;</div>
                        </div>
                    </div>
					<figcaption>Product #5
                        <div class="quantity-input">
                          <input class="minus btn" type="button" value="-">
                          <input id="quantity_4" value="1" class="input-text quantity text" size="4"/>
                          <input class="plus btn" type="button" value="+">
                        </div>
                        <div class="button">
                         <div class="prices">$99</div>
                         <a class="addtocart">
                             <div class="add" rel="watche_5" product="Watche 5" sel="120.99">Add to Cart</div>
                             <div class="added">Added!</div>
                         </a>
                    </div>
                    </figcaption>
				</figure>
			</a>
			<a href="#!" class="flex-item">
                <div class="carousel">
                    <img src="images/2.jpg" alt="" />
                    <img src="images/4.jpg" alt="" />
                    <img src="images/3.jpg" alt="" />
                </div>
				<figure class="" id="fig5">
                    <div class="carousel__images-wrapper" index="5">
                        <div class="controls">
                            <div class="carousel__prev-arrow prev">&lt;</div>
                            <div class="carousel__next-arrow next">&gt;</div>
                        </div>
                    </div>
					<figcaption>Product #6
                        <div class="quantity-input">
                          <input class="minus btn" type="button" value="-">
                          <input id="quantity_5" value="1" class="input-text quantity text" size="4"/>
                          <input class="plus btn" type="button" value="+">
                        </div>
                            <div class="button">
                             <div class="prices">$99</div>
                             <a class="addtocart">
                                 <div class="add" rel="watche_6" product="Watche 6" sel="120.99">Add to Cart</div>
                                 <div class="added">Added!</div>
                             </a>
                        </div>
                    </figcaption>
				</figure>
			</a>
		</section>
	</main>

    <div id="cart">
        <h2>Cart</h2>
        <ul class="cart-items" id="cart_items">

        </ul> <!-- cd-cart-items -->

        <div class="cart-total">
            <p>Total <span>$39.96</span></p>
        </div> <!-- cd-cart-total -->

        <a href="#" class="checkout-btn">Checkout</a>

        <p class="go-to-cart"><a href="#">Go to cart page</a></p>
    </div> <!-- cd-cart -->

<script>

cart_trigger.onclick = function () {
    var cart = document.getElementById('cart');
    toggle_panel_visibility(cart, document.body);
};


function toggle_panel_visibility(panel, body) {
    if (panel.classList.contains('speed-in')) {
        panel.classList.remove('speed-in');
        body.classList.remove('overflow-hidden');
    } else {
        body.classList.add('overflow-hidden');
        panel.classList.add('speed-in');

    }
}

var carousel = document.getElementsByClassName('carousel');

var numberOfImages = [];

var imagesArray = [];

var imagesWrapper = document.getElementsByClassName('carousel__images-wrapper');

var prevArrow = document.getElementsByClassName('prev');
var nextArrow = document.getElementsByClassName('next');


for (var i=0; i<carousel.length; i++){
// создание двумерного массива
    var childNodes = carousel[i].childNodes;
    imagesArray[i] = [];

    for (var j = 0; j < childNodes.length; j++) {
        var currentNode = childNodes[j];
        if (currentNode.nodeName === 'IMG') {
            imagesArray[i].push(currentNode.src);
            currentNode.classList.add('hide');
        }
    }

    numberOfImages[i] = imagesArray[i].length;


imagesWrapper[i].style.backgroundImage = 'url(' + imagesArray[i][0] + ')';
}

var currentImage = [];

for (var i=0; i<carousel.length; i++){

    currentImage[i] = 0;

    prevArrow[i].addEventListener('click', function (e) {
        handleSlideshowArrow('prev', this.parentNode.parentNode.getAttribute('index'));
    });

    nextArrow[i].addEventListener('click',  function (e) {
        handleSlideshowArrow('next', this.parentNode.parentNode.getAttribute('index'));
    });
}

function handleSlideshowArrow(val, i) {
      if (val === 'prev') {
          if (currentImage[i] > 0) {
              currentImage[i]--;
          } else {
              currentImage[i] = numberOfImages[i] - 1;
          }
      } else if (val === 'next') {
          if (currentImage[i] < numberOfImages[i] - 1) {
              currentImage[i]++;
          } else {
              currentImage[i] = 0;
          }
      }
      imagesWrapper[i].classList.add('fade-out');
      imagesWrapper[i].style.backgroundImage = 'url(' + imagesArray[i][currentImage[i]] + ')';
      imagesWrapper[i].classList.remove('fade-out');
  }

  var plus = document.getElementsByClassName('plus');
   for (var i=0;i<plus.length; i++) {
       plus[i].addEventListener('click', function(e) {
       var val = parseInt(e.target.previousElementSibling.getAttribute('value'));
       e.target.previousElementSibling.setAttribute('value', val+1);
       });
   }

   var minus = document.getElementsByClassName('minus');
    for (var i=0;i<minus.length; i++) {
        minus[i].addEventListener('click', function(e) {
        var val = parseInt(e.target.nextElementSibling.getAttribute('value'));
        e.target.nextElementSibling.setAttribute('value', val-1);
        });
    }

    var addButtons = document.getElementsByClassName('add');

    for (var i=0;i<addButtons.length; i++) {
        addButtons[i].addEventListener('click', function(e) {
        var  items = cart_items.children,
              item = this.parentElement.parentElement.parentElement.parentElement;

               var val = this.getAttribute("rel");
               var productName =this.getAttribute('product');
               var price = this.getAttribute('sel');
               var qty = this.parentNode.parentNode.parentNode.querySelector(".quantity-input").getElementsByClassName('quantity')[0].getAttribute('value');

              if(document.getElementById("price_"+val))
              {
                var new_val = parseFloat(document.getElementById("price_"+val).innerHTML);
                new_val +=(parseFloat(qty)*parseFloat(price));

                document.querySelector("span#price_"+val).innerHTML = new_val.toFixed(2);

                var new_qty_val = parseFloat(document.getElementById("qty_"+val).innerHTML);
                new_qty_val +=parseFloat(qty);
                document.getElementById("qty_"+val).innerHTML = new_qty_val;
              }else{
                  var bg = item.previousElementSibling.children[0].children[0].getAttribute('src');

                     cart_items.append(createCartItem(val, productName, price, qty, bg));

              };

        });
    }

    function createCartItem(val, productName, price, qty, bg){
        var li = document.createElement('li');
        li.setAttribute('id',val);
        li.setAttribute("class", "cart-product");
        var span = document.createElement('span');
        var input = document.createElement('input');
        input.setAttribute("class", "qty");
        input.setAttribute('id',"qty_"+val);
        input.setAttribute("value", qty);
        span.appendChild(input);

        var div = document.createElement('div');
        div.setAttribute("class", "price");
        div.innerHTML = productName+'<br/>'+'<span class="item-prices" id="price_'+val+'">'+price+'</span>&nbsp;';

        var a = document.createElement('a');
        a.setAttribute("class", "item-remove img-replace");
        a.setAttribute("href", "#");
        a.innerHTML = "Remove";

        li.appendChild(span);
        li.appendChild(div);
        li.appendChild(a);
        li.querySelector('.qty').style.backgroundImage = 'url(' + bg + ')';

        return li;
    }


////////


    document.getElementById('btm-open-menu').onclick = function () {
        var toggle = document.querySelector('#menushop');
        if (toggle.classList.contains('isvisible')) {
            document.querySelector('#btm-open-menu span:nth-child(1)').classList.remove('child1');
            document.querySelector('#btm-open-menu span:nth-child(2)').classList.remove('child2');
            document.querySelector('#btm-open-menu span:nth-child(3)').classList.remove('child3');
            document.querySelector('#btm-open-menu span:nth-child(4)').classList.remove('child1');
            document.querySelector('#menushop').classList.remove('isvisible');

    }else{
        document.querySelector('#btm-open-menu span:nth-child(1)').classList.add('child1');
        document.querySelector('#btm-open-menu span:nth-child(2)').classList.add('child2');
        document.querySelector('#btm-open-menu span:nth-child(3)').classList.add('child3');
        document.querySelector('#btm-open-menu span:nth-child(4)').classList.add('child1');
        document.querySelector('#menushop').classList.add('isvisible');
        document.querySelector('#navicons').classList.add('isvisible');
    }
};

</script>
</body>
</html>
